% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/extract_single_record_with_labels.R
\name{rc_export_single_record_lab}
\alias{rc_export_single_record_lab}
\title{Export and Label a Single REDCap Record}
\usage{
rc_export_single_record_lab(
  field_name,
  field_value,
  meta = c("online", "offline"),
  path = NULL,
  lang = NULL,
  sheet = 3,
  ...
)
}
\arguments{
\item{field_name}{Character string. The field name to search for
(e.g., \code{'unique_ctr_id'}).}

\item{field_value}{Character string or pattern to match within \code{field_name}.}

\item{meta}{Character, either \code{"online"} or \code{"offline"}.
\itemize{
\item \code{"online"}: Fetches metadata directly from REDCap and applies labels immediately.
\item \code{"offline"}: Loads metadata from a local data dictionary file.
}}

\item{path}{Character. Path to the offline data dictionary file (required if \code{meta = "offline"}).}

\item{lang}{Character. Language code used when applying labels from a multilingual offline dictionary (required if \code{meta = "offline"}).}

\item{sheet}{Integer. Sheet index to load from the offline dictionary file (default = \code{3}).}

\item{...}{Additional arguments passed to underlying functions.}
}
\value{
A data frame containing the full REDCap record for the matching record ID,
with value labels applied to all radio and checkbox variables.
}
\description{
Retrieves a single REDCap record matching a specified field/value pair and
applies value labels to radio and checkbox variables. Labels can be built
using live REDCap metadata via the API ("online" mode) or an offline data
dictionary file ("offline" mode).
}
\details{
\strong{Online mode}:
\itemize{
\item Fetches metadata from REDCap using \code{rc_export_metadata()}.
\item Detects radio and checkbox fields and parses their choice codes and labels.
\item For radio fields, replaces raw codes with the corresponding labels.
\item For checkbox fields:
\itemize{
\item Combines dummy variables (\code{field___code}) into a single grouped variable (\code{field})
containing selected codes.
\item Replaces codes with the corresponding labels.
\item Relocates the grouped variable to appear immediately before the dummy columns.
}
}

\strong{Offline mode}:
\itemize{
\item Loads a local data dictionary via \code{temp_loader()}.
\item Builds a \code{choices_list} and applies labels using \code{ctrdata::label_data()}.
}

Environment variables \code{RC_API_URL} and \code{RC_API_TOKEN} must be set to use online mode.
Use \code{rc_config(api_url, api_token)} to configure API access.
}
\examples{
\dontrun{
# Online labeling
rc_config("https://redcap.your.org/api/", "XYZ123TOKEN")
df <- rc_export_single_record_lab(field_name = "unique_ctr_id",
                                  field_value = "HRL001174",
                                  meta = "online")

# Offline labeling
df <- rc_export_single_record_lab(field_name = "unique_ctr_id",
                                  field_value = "HRL001174",
                                  meta = "offline",
                                  path = "dictionary.xlsx",
                                  lang = "en",
                                  sheet = 3)
}

}
